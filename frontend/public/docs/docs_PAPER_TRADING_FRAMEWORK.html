<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Paper Trading Framework - QuantDesk Documentation</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <style>
        body {
            font-family: 'JetBrains Mono', 'Monaco', 'Consolas', monospace;
            line-height: 1.6;
            color: #ffffff;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #000000;
            font-size: 14px;
        }
        .container {
            background: #000000;
            padding: 30px;
            border-radius: 8px;
            border: 1px solid #333333;
        }
        .back-link {
            margin-bottom: 20px;
        }
        .back-link a {
            color: #3b82f6;
            text-decoration: none;
            font-weight: bold;
            transition: color 0.3s ease;
        }
        .back-link a:hover {
            color: #60a5fa;
            text-decoration: underline;
        }
        h1, h2, h3, h4, h5, h6 {
            color: #ffffff;
            margin-top: 30px;
            margin-bottom: 15px;
            font-weight: 600;
        }
        h1 {
            border-bottom: 2px solid #333333;
            padding-bottom: 10px;
        }
        h2 {
            border-bottom: 1px solid #333333;
            padding-bottom: 8px;
        }
        code {
            background: #1a1a1a;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'JetBrains Mono', 'Monaco', 'Consolas', monospace;
            color: #ffffff;
            border: 1px solid #333333;
        }
        pre {
            background: #0a0a0a;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            border: 1px solid #333333;
            margin: 20px 0;
        }
        pre code {
            background: none;
            padding: 0;
            color: #ffffff;
            border: none;
        }
        blockquote {
            border-left: 4px solid #3b82f6;
            margin: 0;
            padding-left: 20px;
            color: #d9d9d9;
            background: #1a1a1a;
            padding: 15px 20px;
            border-radius: 0 8px 8px 0;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            margin: 20px 0;
            border: 1px solid #333333;
        }
        th, td {
            border: 1px solid #333333;
            padding: 12px;
            text-align: left;
        }
        th {
            background: #1a1a1a;
            font-weight: bold;
            color: #ffffff;
        }
        td {
            color: #d9d9d9;
        }
        ul, ol {
            color: #d9d9d9;
        }
        li {
            margin-bottom: 8px;
        }
        a {
            color: #3b82f6;
            text-decoration: none;
        }
        a:hover {
            color: #60a5fa;
            text-decoration: underline;
        }
        /* Syntax Highlighting Overrides */
        pre[class*="language-"] {
            background: #0a0a0a !important;
            border: 1px solid #333333 !important;
            border-radius: 8px !important;
            padding: 20px !important;
            margin: 20px 0 !important;
            font-family: 'JetBrains Mono', 'Monaco', 'Consolas', monospace !important;
            font-size: 13px !important;
            line-height: 1.5 !important;
        }
        .token.comment { color: #6a9955 !important; }
        .token.keyword { color: #569cd6 !important; }
        .token.string { color: #ce9178 !important; }
        .token.number { color: #b5cea8 !important; }
        .token.function { color: #dcdcaa !important; }
        .token.class-name { color: #4ec9b0 !important; }
        .token.operator { color: #d4d4d4 !important; }
        .token.punctuation { color: #d4d4d4 !important; }
        .token.variable { color: #9cdcfe !important; }
        .token.constant { color: #4fc1ff !important; }
    </style>
</head>
<body>
    <div class="container">
        <div class="back-link">
            <a href="/">&larr; Back to Documentation</a>
        </div>
        <h1>Paper Trading Framework Documentation</h1>
<h2>Overview</h2>
<p>The Paper Trading Framework is a comprehensive backtesting and paper trading system that integrates all your existing strategies, models, features, and indicators. It provides a unified interface for testing and optimizing trading strategies with realistic market simulation.</p>
<h2>Features</h2>
<ul>
<li><strong>Multi-Strategy Support</strong>: Works with all existing strategies (Lag-based, Lorentzian, Logistic Regression, Chandelier Exit)</li>
<li><strong>GPU-Accelerated</strong>: Uses your custom GPU-accelerated features and indicators</li>
<li><strong>Realistic Simulation</strong>: Includes fees, slippage, and order execution simulation</li>
<li><strong>Comprehensive Metrics</strong>: Calculates win rate, Sharpe ratio, drawdown, and more</li>
<li><strong>Parameter Optimization</strong>: Grid search optimization for strategy parameters</li>
<li><strong>Strategy Comparison</strong>: Compare multiple strategies side-by-side</li>
<li><strong>Data Integration</strong>: Works with your existing CSV storage system</li>
<li><strong>Visualization</strong>: Automatic plotting of results and performance metrics</li>
</ul>
<h2>Quick Start</h2>
<h3>1. Basic Backtest</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">src.ml.paper_trading_framework</span> <span class="kn">import</span> <span class="n">PaperTradingFramework</span><span class="p">,</span> <span class="n">BacktestConfig</span>

<span class="c1"># Initialize framework</span>
<span class="n">config</span> <span class="o">=</span> <span class="n">BacktestConfig</span><span class="p">(</span>
    <span class="n">initial_capital</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
    <span class="n">commission</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span>
    <span class="n">slippage</span><span class="o">=</span><span class="mf">0.0005</span>
<span class="p">)</span>
<span class="n">framework</span> <span class="o">=</span> <span class="n">PaperTradingFramework</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>

<span class="c1"># Run backtest</span>
<span class="n">results</span> <span class="o">=</span> <span class="k">await</span> <span class="n">framework</span><span class="o">.</span><span class="n">backtest_strategy</span><span class="p">(</span>
    <span class="n">strategy_name</span><span class="o">=</span><span class="s1">&#39;lorentzian&#39;</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="n">your_data</span>
<span class="p">)</span>

<span class="c1"># Print results</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total Return: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;metrics&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">total_return</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Win Rate: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;metrics&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">win_rate</span><span class="si">:</span><span class="s2">.1%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3>2. Using the CLI</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># Run backtest for Lorentzian strategy</span>
python<span class="w"> </span>scripts/paper_trading_cli.py<span class="w"> </span>backtest<span class="w"> </span>--strategy<span class="w"> </span>lorentzian<span class="w"> </span>--symbols<span class="w"> </span>BTC<span class="w"> </span>--days<span class="w"> </span><span class="m">30</span>

<span class="c1"># Optimize parameters</span>
python<span class="w"> </span>scripts/paper_trading_cli.py<span class="w"> </span>optimize<span class="w"> </span>--strategy<span class="w"> </span>lorentzian<span class="w"> </span>--symbols<span class="w"> </span>BTC<span class="w"> </span>--days<span class="w"> </span><span class="m">60</span><span class="w"> </span>--param-ranges<span class="w"> </span><span class="s2">&quot;lookback_bars=30:50:70,k_neighbors=10:20:30&quot;</span>

<span class="c1"># Compare strategies</span>
python<span class="w"> </span>scripts/paper_trading_cli.py<span class="w"> </span>compare<span class="w"> </span>--strategies<span class="w"> </span>lorentzian<span class="w"> </span>logistic_regression<span class="w"> </span>chandelier_exit<span class="w"> </span>--symbols<span class="w"> </span>BTC<span class="w"> </span>--days<span class="w"> </span><span class="m">30</span>
</code></pre></div>

<h3>3. Run Examples</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># Run comprehensive examples</span>
python<span class="w"> </span>scripts/example_paper_trading.py
</code></pre></div>

<h2>Supported Strategies</h2>
<h3>1. Lag-Based Strategy (<code>lag_based</code>)</h3>
<p><strong>Description</strong>: Trades follower assets based on lagging price movements after significant moves in leader assets.</p>
<p><strong>Parameters</strong>:
- <code>threshold</code>: Minimum leader move percentage (default: 1.5)
- <code>max_lag_minutes</code>: Maximum lag time to consider (default: 60)
- <code>min_correlation</code>: Minimum correlation coefficient (default: 0.3)
- <code>risk_per_trade</code>: Risk per trade percentage (default: 0.02)</p>
<p><strong>Usage</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Multi-asset data required</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;BTC&#39;</span><span class="p">:</span> <span class="n">btc_data</span><span class="p">,</span>  <span class="c1"># Leader</span>
    <span class="s1">&#39;ETH&#39;</span><span class="p">:</span> <span class="n">eth_data</span><span class="p">,</span>  <span class="c1"># Leader</span>
    <span class="s1">&#39;SOL&#39;</span><span class="p">:</span> <span class="n">sol_data</span><span class="p">,</span>  <span class="c1"># Leader</span>
    <span class="s1">&#39;WIF&#39;</span><span class="p">:</span> <span class="n">wif_data</span><span class="p">,</span>  <span class="c1"># Follower</span>
    <span class="s1">&#39;PEPE&#39;</span><span class="p">:</span> <span class="n">pepe_data</span>  <span class="c1"># Follower</span>
<span class="p">}</span>

<span class="n">results</span> <span class="o">=</span> <span class="k">await</span> <span class="n">framework</span><span class="o">.</span><span class="n">backtest_strategy</span><span class="p">(</span>
    <span class="n">strategy_name</span><span class="o">=</span><span class="s1">&#39;lag_based&#39;</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
    <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;threshold&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span> <span class="s1">&#39;max_lag_minutes&#39;</span><span class="p">:</span> <span class="mi">45</span><span class="p">}</span>
<span class="p">)</span>
</code></pre></div>

<h3>2. Lorentzian Classifier (<code>lorentzian</code>)</h3>
<p><strong>Description</strong>: Uses Lorentzian distance metric for pattern recognition and signal generation.</p>
<p><strong>Parameters</strong>:
- <code>lookback_bars</code>: Number of historical bars (default: 50)
- <code>prediction_bars</code>: Bars into future to predict (default: 4)
- <code>k_neighbors</code>: Number of nearest neighbors (default: 20)</p>
<p><strong>Usage</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="n">results</span> <span class="o">=</span> <span class="k">await</span> <span class="n">framework</span><span class="o">.</span><span class="n">backtest_strategy</span><span class="p">(</span>
    <span class="n">strategy_name</span><span class="o">=</span><span class="s1">&#39;lorentzian&#39;</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="n">single_asset_data</span><span class="p">,</span>
    <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;lookback_bars&#39;</span><span class="p">:</span> <span class="mi">40</span><span class="p">,</span> <span class="s1">&#39;k_neighbors&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">}</span>
<span class="p">)</span>
</code></pre></div>

<h3>3. Logistic Regression (<code>logistic_regression</code>)</h3>
<p><strong>Description</strong>: TradingView-style logistic regression with GPU acceleration.</p>
<p><strong>Parameters</strong>:
- <code>lookback</code>: Lookback window size (default: 3)
- <code>learning_rate</code>: Learning rate for gradient descent (default: 0.0009)
- <code>iterations</code>: Training iterations (default: 1000)
- <code>threshold</code>: Signal threshold (default: 0.5)</p>
<p><strong>Usage</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="n">results</span> <span class="o">=</span> <span class="k">await</span> <span class="n">framework</span><span class="o">.</span><span class="n">backtest_strategy</span><span class="p">(</span>
    <span class="n">strategy_name</span><span class="o">=</span><span class="s1">&#39;logistic_regression&#39;</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="n">single_asset_data</span><span class="p">,</span>
    <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;lookback&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">}</span>
<span class="p">)</span>
</code></pre></div>

<h3>4. Chandelier Exit (<code>chandelier_exit</code>)</h3>
<p><strong>Description</strong>: Trailing stop strategy based on ATR with ML enhancements.</p>
<p><strong>Parameters</strong>:
- <code>atr_period</code>: ATR calculation period (default: 22)
- <code>atr_multiplier</code>: ATR multiplier for stops (default: 3.0)
- <code>use_close</code>: Use close prices for calculations (default: True)</p>
<p><strong>Usage</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="n">results</span> <span class="o">=</span> <span class="k">await</span> <span class="n">framework</span><span class="o">.</span><span class="n">backtest_strategy</span><span class="p">(</span>
    <span class="n">strategy_name</span><span class="o">=</span><span class="s1">&#39;chandelier_exit&#39;</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="n">single_asset_data</span><span class="p">,</span>
    <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;atr_period&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span> <span class="s1">&#39;atr_multiplier&#39;</span><span class="p">:</span> <span class="mf">2.5</span><span class="p">}</span>
<span class="p">)</span>
</code></pre></div>

<h2>Configuration Options</h2>
<h3>BacktestConfig</h3>
<div class="codehilite"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">BacktestConfig</span><span class="p">:</span>
    <span class="n">initial_capital</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">10000.0</span>      <span class="c1"># Starting capital</span>
    <span class="n">commission</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.001</span>             <span class="c1"># Commission rate (0.1%)</span>
    <span class="n">slippage</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0005</span>              <span class="c1"># Slippage rate (0.05%)</span>
    <span class="n">max_positions</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span>                <span class="c1"># Max concurrent positions</span>
    <span class="n">risk_per_trade</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.02</span>          <span class="c1"># Risk per trade (2%)</span>
    <span class="n">stop_loss_pct</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span>           <span class="c1"># Stop loss percentage (5%)</span>
    <span class="n">take_profit_pct</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.10</span>         <span class="c1"># Take profit percentage (10%)</span>
    <span class="n">min_confidence</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.3</span>           <span class="c1"># Minimum confidence for entry</span>
    <span class="n">use_gpu</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>                  <span class="c1"># Use GPU acceleration</span>
    <span class="n">save_results</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>             <span class="c1"># Save results to files</span>
    <span class="n">results_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;results/paper_trading&quot;</span>  <span class="c1"># Results directory</span>
</code></pre></div>

<h2>Performance Metrics</h2>
<p>The framework calculates comprehensive performance metrics:</p>
<ul>
<li><strong>Total Return</strong>: Overall percentage return</li>
<li><strong>Win Rate</strong>: Percentage of profitable trades</li>
<li><strong>Profit Factor</strong>: Ratio of gross profit to gross loss</li>
<li><strong>Sharpe Ratio</strong>: Risk-adjusted return measure</li>
<li><strong>Max Drawdown</strong>: Maximum peak-to-trough decline</li>
<li><strong>Average Win/Loss</strong>: Average profit/loss per trade</li>
<li><strong>Best/Worst Trade</strong>: Largest profit and loss</li>
<li><strong>Trade Duration</strong>: Average time in trades</li>
</ul>
<h2>Parameter Optimization</h2>
<h3>Grid Search Optimization</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># Define parameter ranges</span>
<span class="n">param_ranges</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;lookback_bars&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">70</span><span class="p">],</span>
    <span class="s1">&#39;k_neighbors&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>
    <span class="s1">&#39;prediction_bars&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="p">}</span>

<span class="c1"># Run optimization</span>
<span class="n">results</span> <span class="o">=</span> <span class="k">await</span> <span class="n">framework</span><span class="o">.</span><span class="n">optimize_strategy_parameters</span><span class="p">(</span>
    <span class="n">strategy_name</span><span class="o">=</span><span class="s1">&#39;lorentzian&#39;</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
    <span class="n">param_ranges</span><span class="o">=</span><span class="n">param_ranges</span><span class="p">,</span>
    <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;total_return&#39;</span>  <span class="c1"># or &#39;sharpe_ratio&#39;, &#39;win_rate&#39;, etc.</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Best Parameters: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;best_params&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Best Return: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;best_metric&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
</code></pre></div>

<h3>CLI Optimization</h3>
<div class="codehilite"><pre><span></span><code>python<span class="w"> </span>scripts/paper_trading_cli.py<span class="w"> </span>optimize<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--strategy<span class="w"> </span>lorentzian<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--symbols<span class="w"> </span>BTC<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--days<span class="w"> </span><span class="m">60</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--param-ranges<span class="w"> </span><span class="s2">&quot;lookback_bars=30:50:70,k_neighbors=10:20:30&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--metric<span class="w"> </span>total_return
</code></pre></div>

<h2>Strategy Comparison</h2>
<h3>Compare Multiple Strategies</h3>
<div class="codehilite"><pre><span></span><code><span class="n">strategies</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;lorentzian&#39;</span><span class="p">,</span> <span class="s1">&#39;logistic_regression&#39;</span><span class="p">,</span> <span class="s1">&#39;chandelier_exit&#39;</span><span class="p">]</span>
<span class="n">comparison_results</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">strategy</span> <span class="ow">in</span> <span class="n">strategies</span><span class="p">:</span>
    <span class="n">results</span> <span class="o">=</span> <span class="k">await</span> <span class="n">framework</span><span class="o">.</span><span class="n">backtest_strategy</span><span class="p">(</span>
        <span class="n">strategy_name</span><span class="o">=</span><span class="n">strategy</span><span class="p">,</span>
        <span class="n">data</span><span class="o">=</span><span class="n">data</span>
    <span class="p">)</span>
    <span class="n">comparison_results</span><span class="p">[</span><span class="n">strategy</span><span class="p">]</span> <span class="o">=</span> <span class="n">results</span>

<span class="c1"># Print comparison table</span>
<span class="n">framework</span><span class="o">.</span><span class="n">_print_comparison_results</span><span class="p">(</span><span class="n">comparison_results</span><span class="p">)</span>
</code></pre></div>

<h3>CLI Comparison</h3>
<div class="codehilite"><pre><span></span><code>python<span class="w"> </span>scripts/paper_trading_cli.py<span class="w"> </span>compare<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--strategies<span class="w"> </span>lorentzian<span class="w"> </span>logistic_regression<span class="w"> </span>chandelier_exit<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--symbols<span class="w"> </span>BTC<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--days<span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--save
</code></pre></div>

<h2>Data Loading</h2>
<p>The framework integrates with your existing CSV storage system:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">src.data.csv_storage</span> <span class="kn">import</span> <span class="n">CSVStorage</span><span class="p">,</span> <span class="n">StorageConfig</span>

<span class="n">storage</span> <span class="o">=</span> <span class="n">CSVStorage</span><span class="p">(</span><span class="n">StorageConfig</span><span class="p">(</span><span class="n">data_path</span><span class="o">=</span><span class="s2">&quot;data/historical/processed&quot;</span><span class="p">))</span>

<span class="c1"># Load data for backtesting</span>
<span class="n">data</span> <span class="o">=</span> <span class="k">await</span> <span class="n">storage</span><span class="o">.</span><span class="n">load_candles</span><span class="p">(</span>
    <span class="n">exchange</span><span class="o">=</span><span class="s1">&#39;bitget&#39;</span><span class="p">,</span>
    <span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;BTCUSDT&#39;</span><span class="p">,</span>
    <span class="n">timeframe</span><span class="o">=</span><span class="s1">&#39;1h&#39;</span><span class="p">,</span>
    <span class="n">start_date</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">30</span><span class="p">),</span>
    <span class="n">end_date</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
<span class="p">)</span>
</code></pre></div>

<h2>Results and Output</h2>
<h3>Saved Files</h3>
<p>The framework automatically saves results to <code>results/paper_trading/</code>:</p>
<ul>
<li><strong>Metrics</strong>: JSON files with performance metrics</li>
<li><strong>Trades</strong>: CSV files with detailed trade history</li>
<li><strong>Equity Curve</strong>: CSV files with portfolio value over time</li>
<li><strong>Plots</strong>: PNG files with performance visualizations</li>
</ul>
<h3>Example Output Structure</h3>
<div class="codehilite"><pre><span></span><code>results/paper_trading/
├── lorentzian_metrics_20241201_143022.json
├── lorentzian_trades_20241201_143022.csv
├── lorentzian_equity_20241201_143022.csv
├── lorentzian_backtest_20241201_143022.png
├── comparison_20241201_143022.json
└── optimization_results_20241201_143022.csv
</code></pre></div>

<h2>Advanced Usage</h2>
<h3>Custom Risk Management</h3>
<div class="codehilite"><pre><span></span><code><span class="n">config</span> <span class="o">=</span> <span class="n">BacktestConfig</span><span class="p">(</span>
    <span class="n">initial_capital</span><span class="o">=</span><span class="mi">50000</span><span class="p">,</span>
    <span class="n">commission</span><span class="o">=</span><span class="mf">0.0005</span><span class="p">,</span>      <span class="c1"># Lower commission</span>
    <span class="n">slippage</span><span class="o">=</span><span class="mf">0.0002</span><span class="p">,</span>        <span class="c1"># Lower slippage</span>
    <span class="n">max_positions</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>        <span class="c1"># More positions</span>
    <span class="n">risk_per_trade</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>    <span class="c1"># Lower risk per trade</span>
    <span class="n">stop_loss_pct</span><span class="o">=</span><span class="mf">0.03</span><span class="p">,</span>     <span class="c1"># Tighter stop loss</span>
    <span class="n">take_profit_pct</span><span class="o">=</span><span class="mf">0.06</span>    <span class="c1"># Lower take profit</span>
<span class="p">)</span>
</code></pre></div>

<h3>Multi-Timeframe Analysis</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># Test different timeframes</span>
<span class="n">timeframes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;1h&#39;</span><span class="p">,</span> <span class="s1">&#39;4h&#39;</span><span class="p">,</span> <span class="s1">&#39;1d&#39;</span><span class="p">]</span>
<span class="n">results_by_timeframe</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">tf</span> <span class="ow">in</span> <span class="n">timeframes</span><span class="p">:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="k">await</span> <span class="n">storage</span><span class="o">.</span><span class="n">load_candles</span><span class="p">(</span>
        <span class="n">exchange</span><span class="o">=</span><span class="s1">&#39;bitget&#39;</span><span class="p">,</span>
        <span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;BTCUSDT&#39;</span><span class="p">,</span>
        <span class="n">timeframe</span><span class="o">=</span><span class="n">tf</span><span class="p">,</span>
        <span class="n">start_date</span><span class="o">=</span><span class="n">start_date</span><span class="p">,</span>
        <span class="n">end_date</span><span class="o">=</span><span class="n">end_date</span>
    <span class="p">)</span>

    <span class="n">results</span> <span class="o">=</span> <span class="k">await</span> <span class="n">framework</span><span class="o">.</span><span class="n">backtest_strategy</span><span class="p">(</span>
        <span class="n">strategy_name</span><span class="o">=</span><span class="s1">&#39;lorentzian&#39;</span><span class="p">,</span>
        <span class="n">data</span><span class="o">=</span><span class="n">data</span>
    <span class="p">)</span>
    <span class="n">results_by_timeframe</span><span class="p">[</span><span class="n">tf</span><span class="p">]</span> <span class="o">=</span> <span class="n">results</span>
</code></pre></div>

<h3>Walk-Forward Analysis</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># Split data into training and testing periods</span>
<span class="n">train_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">]</span>
<span class="n">test_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">:]</span>

<span class="c1"># Optimize on training data</span>
<span class="n">opt_results</span> <span class="o">=</span> <span class="k">await</span> <span class="n">framework</span><span class="o">.</span><span class="n">optimize_strategy_parameters</span><span class="p">(</span>
    <span class="n">strategy_name</span><span class="o">=</span><span class="s1">&#39;lorentzian&#39;</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="n">train_data</span><span class="p">,</span>
    <span class="n">param_ranges</span><span class="o">=</span><span class="n">param_ranges</span>
<span class="p">)</span>

<span class="c1"># Test on out-of-sample data</span>
<span class="n">test_results</span> <span class="o">=</span> <span class="k">await</span> <span class="n">framework</span><span class="o">.</span><span class="n">backtest_strategy</span><span class="p">(</span>
    <span class="n">strategy_name</span><span class="o">=</span><span class="s1">&#39;lorentzian&#39;</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="n">test_data</span><span class="p">,</span>
    <span class="n">params</span><span class="o">=</span><span class="n">opt_results</span><span class="p">[</span><span class="s1">&#39;best_params&#39;</span><span class="p">]</span>
<span class="p">)</span>
</code></pre></div>

<h2>Troubleshooting</h2>
<h3>Common Issues</h3>
<ol>
<li><strong>No Data Loaded</strong>: Check symbol names and data availability</li>
<li><strong>GPU Memory Issues</strong>: Reduce batch size or use CPU</li>
<li><strong>Strategy Errors</strong>: Check parameter compatibility</li>
<li><strong>Import Errors</strong>: Ensure all dependencies are installed</li>
</ol>
<h3>Debug Mode</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">logging</span>
<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>

<span class="c1"># Run with detailed logging</span>
<span class="n">results</span> <span class="o">=</span> <span class="k">await</span> <span class="n">framework</span><span class="o">.</span><span class="n">backtest_strategy</span><span class="p">(</span>
    <span class="n">strategy_name</span><span class="o">=</span><span class="s1">&#39;lorentzian&#39;</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="n">data</span>
<span class="p">)</span>
</code></pre></div>

<h2>Integration with Existing Systems</h2>
<p>The framework is designed to work seamlessly with your existing:</p>
<ul>
<li><strong>Data Pipeline</strong>: Uses your CSV storage system</li>
<li><strong>GPU Features</strong>: Leverages your custom GPU-accelerated indicators</li>
<li><strong>Strategies</strong>: Integrates all existing strategy implementations</li>
<li><strong>Configuration</strong>: Works with your existing config files</li>
</ul>
<h2>Next Steps</h2>
<ol>
<li><strong>Run Examples</strong>: Start with <code>python scripts/example_paper_trading.py</code></li>
<li><strong>Test Your Data</strong>: Use the CLI to test with your historical data</li>
<li><strong>Optimize Strategies</strong>: Find optimal parameters for your strategies</li>
<li><strong>Compare Performance</strong>: Compare different strategies and timeframes</li>
<li><strong>Extend Framework</strong>: Add new strategies or features as needed</li>
</ol>
<h2>Support</h2>
<p>For questions or issues:
- Check the example scripts for usage patterns
- Review the CLI help: <code>python scripts/paper_trading_cli.py --help</code>
- Examine the generated results and plots
- Check the logs in <code>logs/paper_trading.log</code> </p>
    </div>
</body>
</html>