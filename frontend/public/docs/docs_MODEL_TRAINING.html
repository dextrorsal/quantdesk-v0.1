<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Model Training - QuantDesk Documentation</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <style>
        body {
            font-family: 'JetBrains Mono', 'Monaco', 'Consolas', monospace;
            line-height: 1.6;
            color: #ffffff;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #000000;
            font-size: 14px;
        }
        .container {
            background: #000000;
            padding: 30px;
            border-radius: 8px;
            border: 1px solid #333333;
        }
        .back-link {
            margin-bottom: 20px;
        }
        .back-link a {
            color: #3b82f6;
            text-decoration: none;
            font-weight: bold;
            transition: color 0.3s ease;
        }
        .back-link a:hover {
            color: #60a5fa;
            text-decoration: underline;
        }
        h1, h2, h3, h4, h5, h6 {
            color: #ffffff;
            margin-top: 30px;
            margin-bottom: 15px;
            font-weight: 600;
        }
        h1 {
            border-bottom: 2px solid #333333;
            padding-bottom: 10px;
        }
        h2 {
            border-bottom: 1px solid #333333;
            padding-bottom: 8px;
        }
        code {
            background: #1a1a1a;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'JetBrains Mono', 'Monaco', 'Consolas', monospace;
            color: #ffffff;
            border: 1px solid #333333;
        }
        pre {
            background: #0a0a0a;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            border: 1px solid #333333;
            margin: 20px 0;
        }
        pre code {
            background: none;
            padding: 0;
            color: #ffffff;
            border: none;
        }
        blockquote {
            border-left: 4px solid #3b82f6;
            margin: 0;
            padding-left: 20px;
            color: #d9d9d9;
            background: #1a1a1a;
            padding: 15px 20px;
            border-radius: 0 8px 8px 0;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            margin: 20px 0;
            border: 1px solid #333333;
        }
        th, td {
            border: 1px solid #333333;
            padding: 12px;
            text-align: left;
        }
        th {
            background: #1a1a1a;
            font-weight: bold;
            color: #ffffff;
        }
        td {
            color: #d9d9d9;
        }
        ul, ol {
            color: #d9d9d9;
        }
        li {
            margin-bottom: 8px;
        }
        a {
            color: #3b82f6;
            text-decoration: none;
        }
        a:hover {
            color: #60a5fa;
            text-decoration: underline;
        }
        /* Syntax Highlighting Overrides */
        pre[class*="language-"] {
            background: #0a0a0a !important;
            border: 1px solid #333333 !important;
            border-radius: 8px !important;
            padding: 20px !important;
            margin: 20px 0 !important;
            font-family: 'JetBrains Mono', 'Monaco', 'Consolas', monospace !important;
            font-size: 13px !important;
            line-height: 1.5 !important;
        }
        .token.comment { color: #6a9955 !important; }
        .token.keyword { color: #569cd6 !important; }
        .token.string { color: #ce9178 !important; }
        .token.number { color: #b5cea8 !important; }
        .token.function { color: #dcdcaa !important; }
        .token.class-name { color: #4ec9b0 !important; }
        .token.operator { color: #d4d4d4 !important; }
        .token.punctuation { color: #d4d4d4 !important; }
        .token.variable { color: #9cdcfe !important; }
        .token.constant { color: #4fc1ff !important; }
    </style>
</head>
<body>
    <div class="container">
        <div class="back-link">
            <a href="/">&larr; Back to Documentation</a>
        </div>
        <h1>ðŸ§  Model Training Guide</h1>
<p><em>What is this doc?</em><br />
This guide walks you through training and evaluating ML models for the trading system. It's for anyone who wants to run, tune, or understand the model training process.</p>
<p><a href="ML_MODEL.html">ML Model</a> | <a href="TECHNICAL_STRATEGY.html">Technical Strategy</a> | <a href="../README.html">Project README</a></p>
<h2>Table of Contents</h2>
<ol>
<li><a href="#prerequisites">Prerequisites</a></li>
<li><a href="#basic-model-training">Basic Model Training</a></li>
<li><a href="#walk-forward-optimization">Walk-Forward Optimization</a></li>
<li><a href="#performance-metrics">Performance Metrics</a></li>
<li><a href="#visualization-dashboard">Visualization Dashboard</a></li>
<li><a href="#tips-for-improving-performance">Tips for Improving Performance</a></li>
</ol>
<h2>Prerequisites</h2>
<p>Before training your model, make sure you have:</p>
<ul>
<li><strong>Data Collection System</strong>: Ensure your Binance data collection is running and your database has sufficient historical data</li>
<li><strong>Required Packages</strong>: Install the required Python packages
  <code>bash
  pip install -r requirements.txt</code></li>
<li><strong>GPU Setup (Optional)</strong>: For faster training, configure PyTorch to use your GPU
  <code>bash
  # Check if GPU is available
  python -c "import torch; print(torch.cuda.is_available())"</code></li>
</ul>
<h2>Basic Model Training</h2>
<p>The basic training script trains a model on a fixed train/test split:</p>
<div class="codehilite"><pre><span></span><code>python<span class="w"> </span>scripts/train_model.py<span class="w"> </span>--data-days<span class="w"> </span><span class="m">90</span><span class="w"> </span>--epochs<span class="w"> </span><span class="m">50</span>
</code></pre></div>

<h3>Parameters:</h3>
<ul>
<li><code>--data-days</code>: Number of days of historical data to use (default: 90)</li>
<li><code>--test-size</code>: Fraction of data to use for testing (default: 0.2)</li>
<li><code>--epochs</code>: Number of training epochs (default: 50)</li>
<li><code>--lr</code>: Learning rate (default: 0.001)</li>
<li><code>--batch-size</code>: Batch size for training (default: 64)</li>
<li><code>--save-path</code>: Directory to save the trained model (default: 'models/trained')</li>
</ul>
<h3>Outputs:</h3>
<ul>
<li>Trained model saved to <code>models/trained/lorentzian_classifier_YYYYMMDD_HHMMSS.pt</code></li>
<li>Performance metrics saved to <code>models/trained/metrics_YYYYMMDD_HHMMSS.json</code></li>
<li>Loss curve plot saved to <code>models/trained/loss_curve_YYYYMMDD_HHMMSS.png</code></li>
</ul>
<h2>Walk-Forward Optimization</h2>
<p>For more realistic performance assessment, use walk-forward optimization:</p>
<div class="codehilite"><pre><span></span><code>python<span class="w"> </span>scripts/train_model_walkforward.py<span class="w"> </span>--data-days<span class="w"> </span><span class="m">180</span><span class="w"> </span>--window-size<span class="w"> </span><span class="m">30</span><span class="w"> </span>--test-size<span class="w"> </span><span class="m">7</span><span class="w"> </span>--optimize-metric<span class="w"> </span>sharpe_ratio
</code></pre></div>

<h3>Parameters:</h3>
<ul>
<li><code>--data-days</code>: Number of days of historical data to use (default: 180)</li>
<li><code>--window-size</code>: Size of each training window in days (default: 30)</li>
<li><code>--test-size</code>: Size of each test window in days (default: 7)</li>
<li><code>--epochs</code>: Number of training epochs per window (default: 30)</li>
<li><code>--optimize-metric</code>: Metric to optimize (choices: 'total_return', 'win_rate', 'sharpe_ratio', 'sortino_ratio', 'calmar_ratio'; default: 'sharpe_ratio')</li>
</ul>
<h3>Outputs:</h3>
<ul>
<li>Best model from each window saved to <code>models/trained/best_model_window_N.pt</code></li>
<li>Final best model saved to <code>models/trained/best_model_final_YYYYMMDD_HHMMSS.pt</code></li>
<li>Window metrics saved to <code>models/trained/window_metrics_YYYYMMDD_HHMMSS.csv</code></li>
<li>Visualization outputs saved to <code>models/trained/visualizations/</code></li>
</ul>
<h2>Performance Metrics</h2>
<p>The system calculates and tracks these key performance metrics:</p>
<h3>Core Performance Metrics</h3>
<ul>
<li><strong>Return on Investment (ROI)</strong>: Total percentage return</li>
<li><strong>Win Rate</strong>: Percentage of winning trades</li>
<li><strong>Percentage Profitable</strong>: Percentage of profitable periods</li>
<li><strong>Maximum Drawdown</strong>: Largest peak-to-trough decline</li>
</ul>
<h3>Risk-Adjusted Metrics</h3>
<ul>
<li><strong>Sharpe Ratio</strong>: Risk-adjusted returns (higher is better, &gt;1.5 is good)</li>
<li><strong>Sortino Ratio</strong>: Like Sharpe but only penalizes downside volatility</li>
<li><strong>Calmar Ratio</strong>: Annual return divided by maximum drawdown</li>
</ul>
<h3>Advanced Metrics</h3>
<ul>
<li><strong>Profit Factor</strong>: Gross profits divided by gross losses (&gt;2 is strong)</li>
<li><strong>Expected Value</strong>: Average profit per trade</li>
<li><strong>Risk-Reward Ratio</strong>: Potential profit relative to potential loss</li>
<li><strong>Recovery Factor</strong>: Total net profit divided by max drawdown</li>
<li><strong>Maximum Consecutive Losses</strong>: Resilience during losing streaks</li>
</ul>
<h2>Visualization Dashboard</h2>
<p>To visualize model performance, use the dashboard:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Install dashboard requirements</span>
pip<span class="w"> </span>install<span class="w"> </span>-r<span class="w"> </span>scripts/dashboard/requirements-dashboard.txt

<span class="c1"># Run the dashboard</span>
python<span class="w"> </span>scripts/dashboard/model_dashboard.py
</code></pre></div>

<p>The dashboard will be available at http://127.0.0.1:8050/ and includes:
- Model performance metrics
- Training session comparison
- Window-by-window performance visualization
- Metrics correlation analysis</p>
<h2>Tips for Improving Performance</h2>
<h3>1. Feature Engineering</h3>
<ul>
<li>Add additional technical indicators</li>
<li>Experiment with different timeframes</li>
<li>Include market sentiment data</li>
<li>Consider inter-market relationships (BTC/ETH influence on SOL)</li>
</ul>
<h3>2. Model Tuning</h3>
<ul>
<li>Adjust threshold values for signal generation</li>
<li>Experiment with different model architectures</li>
<li>Use learning rate schedulers for better convergence</li>
<li>Implement early stopping to prevent overfitting</li>
</ul>
<h3>3. Dataset Optimization</h3>
<ul>
<li>Ensure balanced class distribution</li>
<li>Increase historical data timespan</li>
<li>Use more granular data for training</li>
<li>Experiment with different labeling strategies</li>
</ul>
<h3>4. Hyperparameter Optimization</h3>
<p>Try these hyperparameters:
- Learning rates: [0.01, 0.001, 0.0001]
- Batch sizes: [32, 64, 128]
- Hidden layer sizes: [32, 64, 128, 256]
- Dropout rates: [0.1, 0.2, 0.3, 0.5]</p>
<h3>5. Risk Management</h3>
<ul>
<li>Implement position sizing based on volatility</li>
<li>Use asymmetric thresholds (higher for buy signals)</li>
<li>Add stop-loss and take-profit logic</li>
<li>Consider time-based exit strategies</li>
</ul>
<h2>Advanced Techniques</h2>
<p>For even better results, consider these advanced techniques:</p>
<ol>
<li><strong>Ensemble Methods</strong>: Combine multiple models for more robust predictions</li>
<li><strong>Adversarial Validation</strong>: Ensure your validation set truly represents live conditions</li>
<li><strong>Monte Carlo Simulation</strong>: Assess strategy robustness under different market conditions</li>
<li><strong>Reinforcement Learning</strong>: Train an agent to learn optimal trading policies</li>
<li><strong>Transfer Learning</strong>: Pretrain on related markets, then fine-tune on Solana</li>
</ol>
<hr />
<p>Remember that the goal is to build a robust model that performs well across various market conditions, not just one that fits historical data perfectly. Focus on risk-adjusted metrics like Sharpe and Sortino ratios rather than just total returns. </p>
<h2>See Also</h2>
<ul>
<li><a href="../README.html">Project README</a> â€” Project overview and structure</li>
<li><a href="ML_MODEL.html">ML Model Architecture</a> â€” Model structure and integration</li>
<li><a href="TECHNICAL_STRATEGY.html">Technical Strategy</a> â€” How training fits into the trading system</li>
<li><a href="NEON_PIPELINE.html">Neon Data Pipeline</a> â€” Data ingestion and feature engineering</li>
<li><a href="../scripts/train_model.py">scripts/train_model.py</a> â€” Main training script</li>
<li><a href="../scripts/train_model_walkforward.py">scripts/train_model_walkforward.py</a> â€” Walk-forward optimization script</li>
<li><a href="../scripts/dashboard/model_dashboard.py">scripts/dashboard/model_dashboard.py</a> â€” Visualization dashboard </li>
</ul>
    </div>
</body>
</html>